pdf(file = paste0(dir,"QC_boxplot_normalization.pdf"),
width = 6,
height = 4)
QC_boxplot(data_input,data_group = data_group_molm13_VEN,
value_colour = value_colour,
title = "normalized data")
dev.off()
pdf(file = paste0(dir,"QC_pca_normalization.pdf"),
width = 7,
height = 7)
QC_PCA(data = log2(data_input+1),
data_group = data_group_molm13_VEN,
value_colour = value_colour)
dev.off()
pdf(file = paste0(dir,"QC_heatmap_normalization.pdf"),
width = 6,
height = 6)
QC_heatmap(data = data_input,data_group = data_group_molm13_VEN,
value_colour = value_colour)
dev.off()
dir <- "./03_Result/QC/neg/MV4_11/VEN_WT/"
pdf(file = paste0(dir,"QC_boxplot_normalization.pdf"),
width = 6,
height = 4)
QC_boxplot(data_input,data_group = data_group_mv4_11_VEN,
value_colour = value_colour,
title = "normalized data")
dev.off()
pdf(file = paste0(dir,"QC_pca_normalization.pdf"),
width = 7,
height = 7)
QC_PCA(data = log2(data_input+1),
data_group = data_group_mv4_11_VEN,
value_colour = value_colour)
dev.off()
pdf(file = paste0(dir,"QC_heatmap_normalization.pdf"),
width = 6,
height = 6)
QC_heatmap(data = data_input,data_group = data_group_mv4_11_VEN,
value_colour = value_colour)
dev.off()
dir <- "./03_Result/QC/neg/OCI/VEN_WT/"
pdf(file = paste0(dir,"QC_boxplot_normalization.pdf"),
width = 6,
height = 4)
QC_boxplot(data_input,data_group = data_group_OCI_VEN,
value_colour = value_colour,
title = "normalized data")
colnames(data_group_OCI_VEN)[2] <- "group"
pdf(file = paste0(dir,"QC_boxplot_normalization.pdf"),
width = 6,
height = 4)
QC_boxplot(data_input,data_group = data_group_OCI_VEN,
value_colour = value_colour,
title = "normalized data")
dev.off()
pdf(file = paste0(dir,"QC_pca_normalization.pdf"),
width = 7,
height = 7)
QC_PCA(data = log2(data_input+1),
data_group = data_group_OCI_VEN,
value_colour = value_colour)
dev.off()
pdf(file = paste0(dir,"QC_heatmap_normalization.pdf"),
width = 6,
height = 6)
QC_heatmap(data = data_input,data_group = data_group_OCI_VEN,
value_colour = value_colour)
dev.off()
pdf(file = paste0(dir,"QC_heatmap_normalization.pdf"),
width = 6,
height = 6)
QC_heatmap(data = data_input,data_group = data_group_OCI_VEN,
value_colour = value_colour)
dev.off()
pdf(file = paste0(dir,"QC_boxplot_normalization.pdf"),
width = 6,
height = 4)
QC_boxplot(data_input,data_group = data_group_OCI_VEN,
value_colour = value_colour,
title = "normalized data")
dev.off()
# 配色设置
value_colour <- c("6W" = "#E64B35FF",
#"2W" = "#F2A200",
"WT" = "#4DBBD5FA")
dir <- "./03_Result/QC/neg/OCI/6W_WT/"
pdf(file = paste0(dir,"QC_boxplot_normalization.pdf"),
width = 6,
height = 4)
QC_boxplot(data_input,data_group = data_group_OCI_6w,
value_colour = value_colour,
title = "normalized data")
dev.off()
pdf(file = paste0(dir,"QC_pca_normalization.pdf"),
width = 7,
height = 7)
QC_PCA(data = log2(data_input+1),
data_group = data_group_OCI_6w,
value_colour = value_colour)
dev.off()
pdf(file = paste0(dir,"QC_heatmap_normalization.pdf"),
width = 6,
height = 6)
QC_heatmap(data = data_input,data_group = data_group_OCI_6w,
value_colour = value_colour)
dev.off()
dir <- "./03_Result/QC/neg/MV4_11/6W_WT/"
pdf(file = paste0(dir,"QC_boxplot_normalization.pdf"),
width = 6,
height = 4)
QC_boxplot(data_input,data_group = data_group_mv4_11_6w,
value_colour = value_colour,
title = "normalized data")
dev.off()
pdf(file = paste0(dir,"QC_pca_normalization.pdf"),
width = 7,
height = 7)
QC_PCA(data = log2(data_input+1),
data_group = data_group_mv4_11_6w,
value_colour = value_colour)
dev.off()
pdf(file = paste0(dir,"QC_heatmap_normalization.pdf"),
width = 6,
height = 6)
QC_heatmap(data = data_input,data_group = data_group_mv4_11_6w,
value_colour = value_colour)
dev.off()
dir <- "./03_Result/QC/neg/MOLM13/6W_WT/"
View(data_group_molm13_6w)
data_group_molm13_6w <- data_group_OCI_VEN[-grep("2w",data_group_OCI_VEN$id),]
View(data_group_molm13_2w)
data_group_molm13_6w <- data_group_molm13_VEN[-grep("2w",data_group_molm13_VEN$id),]
dir <- "./03_Result/QC/neg/MOLM13/6W_WT/"
pdf(file = paste0(dir,"QC_boxplot_normalization.pdf"),
width = 6,
height = 4)
QC_boxplot(data_input,data_group = data_group_molm13_6w,
value_colour = value_colour,
title = "normalized data")
dev.off()
pdf(file = paste0(dir,"QC_pca_normalization.pdf"),
width = 7,
height = 7)
QC_PCA(data = log2(data_input+1),
data_group = data_group_molm13_6w,
value_colour = value_colour)
dev.off()
pdf(file = paste0(dir,"QC_heatmap_normalization.pdf"),
width = 6,
height = 6)
QC_heatmap(data = data_input,data_group = data_group_molm13_6w,
value_colour = value_colour)
dev.off()
dir <- "./03_Result/QC/neg/MOLM13/2W_WT/"
# 配色设置
value_colour <- c(#"6W" = "#E64B35FF",
"2W" = "#F2A200",
"WT" = "#4DBBD5FA")
pdf(file = paste0(dir,"QC_boxplot_normalization.pdf"),
width = 6,
height = 4)
QC_boxplot(data_input,data_group = data_group_molm13_2w,
value_colour = value_colour,
title = "normalized data")
dev.off()
pdf(file = paste0(dir,"QC_pca_normalization.pdf"),
width = 7,
height = 7)
QC_PCA(data = log2(data_input+1),
data_group = data_group_molm13_2w,
value_colour = value_colour)
dev.off()
pdf(file = paste0(dir,"QC_heatmap_normalization.pdf"),
width = 6,
height = 6)
QC_heatmap(data = data_input,data_group = data_group_molm13_2w,
value_colour = value_colour)
dev.off()
dir <- "./03_Result/QC/neg/MV4_11/2W_WT/"
pdf(file = paste0(dir,"QC_boxplot_normalization.pdf"),
width = 6,
height = 4)
QC_boxplot(data_input,data_group = data_group_mv4_11_2w,
value_colour = value_colour,
title = "normalized data")
dev.off()
pdf(file = paste0(dir,"QC_pca_normalization.pdf"),
width = 7,
height = 7)
QC_PCA(data = log2(data_input+1),
data_group = data_group_mv4_11_2w,
value_colour = value_colour)
dev.off()
pdf(file = paste0(dir,"QC_heatmap_normalization.pdf"),
width = 6,
height = 6)
QC_heatmap(data = data_input,data_group = data_group_mv4_11_2w,
value_colour = value_colour)
dev.off()
dir <- "./03_Result/QC/neg/OCI/2W_WT/"
pdf(file = paste0(dir,"QC_boxplot_normalization.pdf"),
width = 6,
height = 4)
QC_boxplot(data_input,data_group = data_group_OCI_2w,
value_colour = value_colour,
title = "normalized data")
dev.off()
pdf(file = paste0(dir,"QC_pca_normalization.pdf"),
width = 7,
height = 7)
QC_PCA(data = log2(data_input+1),
data_group = data_group_OCI_2w,
value_colour = value_colour)
dev.off()
pdf(file = paste0(dir,"QC_heatmap_normalization.pdf"),
width = 6,
height = 6)
QC_heatmap(data = data_input,data_group = data_group_OCI_2w,
value_colour = value_colour)
dev.off()
View(QC_heatmap)
library(metaX)
library(readxl)
library(ggplot2)
library(ggrepel)
library(readr)
library(dplyr)
library(openxlsx)
pfile <- system.file("extdata/MTBLS79.txt",package = "metaX")
sfile <- system.file("extdata/MTBLS79_sampleList.txt",package = "metaX")
rawPeaks(para) <- read.delim(pfile,check.names = FALSE)
## 4.2 PLS-DA ----
# 载入metaX package
para <- new("metaXpara")
pfile <- system.file("extdata/MTBLS79.txt",package = "metaX")
sfile <- system.file("extdata/MTBLS79_sampleList.txt",package = "metaX")
rawPeaks(para) <- read.delim(pfile,check.names = FALSE)
View(para)
sampleListFile(para) <- sfile
para <- reSetPeaksData(para)
para <- missingValueImpute(para)
para <- metaX::normalize(para,method="pqn")
plsdaPara <- new("plsDAPara")
plsdaPara@nperm <- 100
plsda.res <- runPLSDA(para = para,plsdaPara = plsdaPara,sample = c("S","C"),valueID="value")
cat("R2Y: ",plsda.res$plsda$res$R2,"\n")
## 4.2 PLS-DA ----
# 载入metaX package
para <- new("metaXpara")
pfile <- system.file("extdata/MTBLS79.txt",package = "metaX")
sfile <- system.file("extdata/MTBLS79_sampleList.txt",package = "metaX")
rawPeaks(para) <- read.delim(pfile,check.names = FALSE)
sampleListFile(para) <- sfile
para <- reSetPeaksData(para)
para <- missingValueImpute(para)
para <- metaX::normalize(para,method="pqn")
plsdaPara <- new("plsDAPara")
plsdaPara@nperm <- 100
plsda.res <- runPLSDA(para = para,plsdaPara = plsdaPara,sample = c("S","C"),valueID="value")
pfile <- read.xlsx("./01_Data/meta_intensity_class_neg.xlsx")
View(pfile)
sfile <- read.xlsx("./01_Data/sam_qc_infor_neg.xlsx")
View(para)
para@VIP
para@rawPeaks
para@sampleListHead
?rawPeaks
??rawPeaks
## 4.2 PLS-DA ----
# 载入metaX package
para <- new("metaXpara")
View(para)
pfile <- system.file("extdata/MTBLS79.txt",package = "metaX")
sfile <- system.file("extdata/MTBLS79_sampleList.txt",package = "metaX")
rawPeaks(para) <- read.delim(pfile,check.names = FALSE)
sampleListFile(para) <- sfile
para@sampleListFile
para@rawPeaks
View(para@rawPeaks)
sfile <- read.xlsx("./01_Data/sam_qc_infor_neg.xlsx")
## 4.2 PLS-DA ----
# 载入metaX package
para <- new("metaXpara")
pfile <- read.xlsx("./01_Data/meta_intensity_class_neg.xlsx")
sfile <- read.xlsx("./01_Data/sam_qc_infor_neg.xlsx")
rawPeaks(para) <- read.delim(pfile,check.names = FALSE)
pfile <- "./01_Data/meta_intensity_class_neg.xlsx"
sfile <- "./01_Data/sam_qc_infor_neg.xlsx"
rawPeaks(para) <- read.xlsx(pfile)
sampleListFile(para) <- sfile
View(para)
rawPeaks(para) <- read.xlsx(pfile)
sampleListFile(para) <- sfile
para <- reSetPeaksData(para)
rawPeaks(para) <- read.xlsx(pfile)
para@xcmsSetObj
## 4.2 PLS-DA ----
# 载入metaX package
para <- new("metaXpara")
pfile <- read.xlsx("./01_Data/meta_intensity_class_neg.xlsx")
sfile <- read.xlsx("./01_Data/sam_qc_infor_neg.xlsx")
View(sfile)
View(pfile)
pfile <- pfile[,-c(2:13)]
pfile <- pfile[,-grep("4w",colnames(pfile))]
View(pfile)
View(sfile)
View(pfile)
rawPeaks(para) <- pfile
sampleListFile(para) <- sfile
sampleListFile(para) <- "./01_Data/sam_qc_infor_neg.xlsx"
para@sampleListHead
para@sampleListFile
para <- reSetPeaksData(para)
pfile_1 <- system.file("extdata/MTBLS79.txt",package = "metaX")
a <- read.delim(pfile_1,check.names = FALSE)
View(a)
sfile_1 <- system.file("extdata/MTBLS79_sampleList.txt",package = "metaX")
b <- read.delim(sfile_1,check.names = FALSE)
View(b)
sfile <- "./01_Data/sam_qc_infor_neg.txt"
View(pfile)
colnames(pfile) <- gsub("cas_","",colnames(pfile))
colnames(pfile) <- gsub("neg_","",colnames(pfile))
colnames(pfile) <- gsub("w","W",colnames(pfile))
rawPeaks(para) <- pfile
sampleListFile(para) <- sfile
## 4.2 PLS-DA ----
# 载入metaX package
para <- new("metaXpara")
rawPeaks(para) <- pfile
sampleListFile(para) <- sfile
para <- reSetPeaksData(para)
View(para)
sfile <- "./01_Data/sam_qc_infor_neg.txt"
sampleListFile(para) <- sfile
para <- reSetPeaksData(para)
View(para)
colnames(pfile)[1] <- "name"
para <- reSetPeaksData(para)
colnames(pfile)[1] <- "ID"
para <- reSetPeaksData(para)
pfile <- t(pfile)
para <- reSetPeaksData(para)
View(pfile)
pfile <- t(pfile)
pfile <- as.data.frame(pfile)
rownames(pfile) <- pfile$ID
pfile <- pfile[,-1]
para <- reSetPeaksData(para)
pfile <- t(pfile)
para <- reSetPeaksData(para)
## 4.2 PLS-DA ----
# 载入metaX package
para <- new("metaXpara")
pfile <- "./01_Data/meta_intensity_class_neg.txt"
sfile <- "./01_Data/sam_qc_infor_neg.txt"
rawPeaks(para) <- read.delim(pfile,check.names = FALSE)
sampleListFile(para) <- sfile
para <- reSetPeaksData(para)
View(para)
View(para)
## 4.2 PLS-DA ----
# 载入metaX package
para <- new("metaXpara")
pfile <- "./01_Data/neg_t.txt"
sfile <- "./01_Data/sam_qc_infor_neg.txt"
rawPeaks(para) <- read.delim(pfile,check.names = FALSE)
sampleListFile(para) <- sfile
para <- reSetPeaksData(para)
View(para)
para@rawPeaks
View(para@rawPeaks)
para <- reSetPeaksData(para)
sampleListFile(para) <- sfile
sampleListFile(para) <- sfile
para <- reSetPeaksData(para)
pfile <- "./01_Data/meta_intensity_class_neg.txt"
rawPeaks(para) <- read.delim(pfile,check.names = FALSE)
sampleListFile(para) <- sfile
para <- reSetPeaksData(para)
sfile <- "./01_Data/sam_qc_infor_neg.txt"
rawPeaks(para) <- read.delim(pfile,check.names = FALSE)
sampleListFile(para) <- sfile
para <- reSetPeaksData(para)
sampleList <- read.delim(sfile)
View(sampleList)
para <- reSetPeaksData(para)
## 4.2 PLS-DA ----
# 载入metaX package
para <- new("metaXpara")
pfile <- "./01_Data/meta_intensity_class_neg.txt"
sfile <- "./01_Data/sam_qc_infor_neg.txt"
rawPeaks(para) <- read.delim(pfile,check.names = FALSE)
sampleListFile(para) <- sfile
sampleList <- read.delim(sfile)
para <- reSetPeaksData(para)
View(para)
para <- metaX::normalize(para,method="pqn")
plsdaPara <- new("plsDAPara")
plsdaPara@nperm <- 200
plsda.res <- runPLSDA(para = para,plsdaPara = plsdaPara,
sample = c("MOLM13_2W","MOLM13_WT"),valueID="value")
View(para@sampleList)
plsda.res <- runPLSDA(para = para,plsdaPara = plsdaPara,
sample = c("MOLM13_6W","MOLM13_WT"),valueID="value")
View(para@rawPeaks)
# 选择最优主成分
best_comp <- selectBestComponent(
para = para,               # 输入的metaXpara对象
np = 10,                    # 最大主成分数为10
sample = c("S", "C"),       # 选择的样本组
scale = "uv",           # 数据标准化方法：pareto
valueID = "value",          # 代谢物定量数据列名称
k = 7                       # 5折交叉验证
)
View(para@peaksData)
# 选择最优主成分
best_comp <- selectBestComponent(
para = para,               # 输入的metaXpara对象
np = 10,                    # 最大主成分数为10
sample = c("MOLM13_6W", "MOLM13_WT"),       # 选择的样本组
scale = "uv",           # 数据标准化方法：pareto
valueID = "value",          # 代谢物定量数据列名称
k = 7                       # 5折交叉验证
)
para@pairTest
print(para@sampleList)
# 选择最优主成分
best_comp <- selectBestComponent(
para = para,               # 输入的metaXpara对象
np = 10,                    # 最大主成分数为10
sample = c("MOLM13_6W", "MOLM13_WT"),       # 选择的样本组
scale = "uv",           # 数据标准化方法：pareto
valueID = "value",          # 代谢物定量数据列名称
k = 7                       # 7折交叉验证
)
# 选择最优主成分
best_comp <- selectBestComponent(
para = para,               # 输入的metaXpara对象
np = 10,                    # 最大主成分数为10
class = c("MOLM13_6W", "MOLM13_WT"),       # 选择的样本组
scale = "uv",           # 数据标准化方法：pareto
valueID = "value",          # 代谢物定量数据列名称
k = 7                       # 7折交叉验证
)
# 选择最优主成分
best_comp <- selectBestComponent(
para = para,               # 输入的metaXpara对象
np = 10,                     # 最大主成分数为10
sample = c("MOLM13_6W_1", "MOLM13_6W_2","MOLM13_6W_3",
"MOLM13_WT_1", "MOLM13_WT_2","MOLM13_WT_3"),       # 选择的样本组
scale = "uv",           # 数据标准化方法：pareto
valueID = "value",          # 代谢物定量数据列名称
k = 7                       # 7折交叉验证
)
# 选择最优主成分
best_comp <- selectBestComponent(
para = para,               # 输入的metaXpara对象
np = 10,                     # 最大主成分数为10
sample = c("MOLM13_6W_1", "MOLM13_6W_2","MOLM13_6W_3",
"MOLM13_WT_1", "MOLM13_WT_2","MOLM13_WT_3"),       # 选择的样本组
scale = "uv",           # 数据标准化方法：pareto
valueID = "value",          # 代谢物定量数据列名称
k = 7                       # 7折交叉验证
)
rs <- createModels(para,method="plsda",group=c("MOLM13_6W","MOLM13_WT"),valueID="value")
# 选择最优主成分
best_comp <- selectBestComponent(
para = para,               # 输入的metaXpara对象
np = 10,                     # 最大主成分数为10
sample = c("MOLM13_6W_1", "MOLM13_6W_2","MOLM13_6W_3",
"MOLM13_WT_1", "MOLM13_WT_2","MOLM13_WT_3"),       # 选择的样本组
scale = "uv",           # 数据标准化方法：pareto
valueID = "value",          # 代谢物定量数据列名称
k = 7                       # 7折交叉验证
)
## 4.2 PLS-DA ----
# 载入metaX package
# 定量数据第一列列名必须为“name”
# 分组数据QC样本分组必须设置为"NA"
para <- new("metaXpara")
pfile <- "./01_Data/meta_intensity_class_neg.txt"
sfile <- "./01_Data/sam_qc_infor_neg.txt"
rawPeaks(para) <- read.delim(pfile,check.names = FALSE)
sampleListFile(para) <- sfile
para <- reSetPeaksData(para)
#para <- missingValueImpute(para)
para <- metaX::normalize(para,method="pqn")
plsdaPara <- new("plsDAPara")
# 选择最优主成分
best_comp <- selectBestComponent(
para = para,               # 输入的metaXpara对象
np = 10,                     # 最大主成分数为10
sample = c("MOLM13_6W_1", "MOLM13_6W_2","MOLM13_6W_3",
"MOLM13_WT_1", "MOLM13_WT_2","MOLM13_WT_3"),       # 选择的样本组
scale = "uv",           # 数据标准化方法：pareto
valueID = "value",          # 代谢物定量数据列名称
k = 7                       # 7折交叉验证
)
# 选择最优主成分
best_comp <- selectBestComponent(
para = para,               # 输入的metaXpara对象
np = 10,                     # 最大主成分数为10
sample = c("MOLM13_6W",
"MOLM13_WT"),       # 选择的样本组
scale = "uv",           # 数据标准化方法：pareto
valueID = "value",          # 代谢物定量数据列名称
k = 7                       # 7折交叉验证
)
?selectBestComponent
